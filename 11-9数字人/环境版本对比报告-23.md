# 环境版本对比报告

## 对比结果

**结论**: ❌ **当前环境版本配置与目标列表不一致**

### 统计信息

- ✅ **匹配的包**: 5 个
- ❌ **版本不匹配的包**: 44 个
- ⚠️ **未安装的包**: 14 个

## 详细对比

### ✅ 匹配的包 (5个)

| 包名 | 当前版本 | 目标版本 | 状态 |
|------|---------|---------|------|
| apstone | 0.0.8 | 0.0.8 | ✅ |
| cv2box | 0.5.9 | 0.5.9 | ✅ |
| numexpr | 2.8.6 | 2.8.6 | ✅ |
| scipy | 1.10.1 | 1.10.1 | ✅ |
| typeguard | 2.13.3 | 2.13.3 | ✅ |

### ❌ 版本不匹配的包 (44个)

#### 关键包（影响最大）

| 包名 | 当前版本 | 目标版本 | 差异 |
|------|---------|---------|------|
| **torch** | 2.4.1 | 2.1.2+cu118 | ⚠️ **重要** |
| **torchvision** | 0.19.1 | 0.16.2 | ⚠️ **重要** |
| **torchaudio** | 2.4.1 | 2.1.2 | ⚠️ **重要** |
| **onnxruntime-gpu** | 1.19.2 | 1.18.0 | ⚠️ **重要** (之前降级到1.16.0) |
| **opencv-python** | 4.11.0.86 | 4.7.0.72 | ⚠️ **重要** |
| **librosa** | 0.11.0 | 0.8.1 | ⚠️ **重要** |
| **numpy** | 1.24.4 | 1.22.4 | ⚠️ **重要** |

#### 其他不匹配的包

| 包名 | 当前版本 | 目标版本 |
|------|---------|---------|
| audioread | 3.0.1 | 2.1.9 |
| cffi | 1.17.1 | 1.15.0 |
| charset-normalizer | 3.4.1 | 2.0.12 |
| click | 8.1.8 | 8.1.3 |
| cycler | 0.12.1 | 0.11.0 |
| decorator | 5.2.1 | 5.1.1 |
| filelock | 3.16.1 | 3.7.1 |
| flatbuffers | 25.2.10 | 2.0 |
| fonttools | 4.56.0 | 4.36.0 |
| huggingface-hub | 0.29.3 | 0.0.8 |
| idna | 3.10 | 3.3 |
| imageio | 2.35.1 | 2.19.3 |
| importlib-metadata | 8.5.0 | 4.11.4 |
| joblib | 1.4.2 | 1.1.0 |
| kiwisolver | 1.4.7 | 1.4.4 |
| matplotlib | 3.7.5 | 3.5.3 |
| networkx | 3.1 | 2.6.3 |
| numba | 0.58.1 | 0.55.2 |
| packaging | 24.2 | 21.3 |
| pillow | 10.4.0 | 9.1.1 |
| pooch | 1.8.2 | 1.6.0 |
| protobuf | 5.29.4 | 4.21.5 |
| pycparser | 2.22 | 2.21 |
| pyparsing | 3.1.4 | 3.0.9 |
| python-dateutil | 2.9.0.post0 | 2.8.2 |
| pywavelets | 1.4.1 | 1.3.0 |
| pyyaml | 6.0.2 | 6.0 |
| requests | 2.32.3 | 2.27.1 |
| scikit-image | 0.21.0 | 0.19.3 |
| scikit-learn | 1.3.2 | 1.0.2 |
| six | 1.17.0 | 1.16.0 |
| soundfile | 0.13.1 | 0.10.3.post1 |
| threadpoolctl | 3.5.0 | 3.1.0 |
| tifffile | 2023.7.10 | 2021.11.2 |
| tqdm | 4.67.1 | 4.64.0 |
| typing-extensions | 4.12.2 | 4.2.0 |
| urllib3 | 2.2.3 | 1.26.9 |
| zipp | 3.20.2 | 3.8.0 |

### ⚠️ 未安装的包 (14个)

| 包名 | 目标版本 | 状态 |
|------|---------|------|
| appdirs | 1.4.4 | ❌ 未安装 |
| colorama | 0.4.4 | ❌ 未安装 |
| freetype-py | 2.3.0 | ❌ 未安装 |
| kornia | 0.6.6 | ❌ 未安装 |
| psutil | 5.9.1 | ❌ 未安装 |
| pyglet | 1.5.26 | ❌ 未安装 |
| pyopengl | 3.1.0 | ❌ 未安装 |
| pyrender | 0.1.45 | ❌ 未安装 |
| regex | 2022.6.2 | ❌ 未安装 |
| resampy | 0.2.2 | ❌ 未安装 |
| sacremoses | 0.0.53 | ❌ 未安装 |
| tokenizers | 0.10.3 | ❌ 未安装 |
| transformers | 4.6.1 | ❌ 未安装 |
| trimesh | 3.12.7 | ❌ 未安装 |

## 问题分析

### 1. 关键包版本不匹配

**PyTorch 相关**:
- 当前: torch 2.4.1, torchvision 0.19.1, torchaudio 2.4.1
- 目标: torch 2.1.2+cu118, torchvision 0.16.2, torchaudio 2.1.2
- **影响**: 可能导致兼容性问题，特别是 CUDA 版本

**ONNX Runtime**:
- 当前: onnxruntime-gpu 1.19.2
- 目标: onnxruntime-gpu 1.18.0
- **影响**: 之前我们已经降级到 1.16.0 来解决队列阻塞问题，但现在又变成了 1.19.2

**OpenCV**:
- 当前: opencv-python 4.11.0.86
- 目标: opencv-python 4.7.0.72
- **影响**: 可能影响图像处理功能

**Librosa**:
- 当前: librosa 0.11.0
- 目标: librosa 0.8.1
- **影响**: 可能影响音频处理功能

**NumPy**:
- 当前: numpy 1.24.4
- 目标: numpy 1.22.4
- **影响**: 可能影响数值计算和兼容性

### 2. 缺失的包

14 个包未安装，包括：
- **transformers**: 深度学习模型库
- **tokenizers**: 文本处理
- **kornia**: 计算机视觉库
- **pyrender, pyglet, pyopengl**: 3D 渲染相关
- **psutil**: 系统监控（FastAPI 服务需要）

## 建议

### 方案 1: 完全对齐目标版本（推荐）

重新安装所有包到目标版本，确保环境一致性。

### 方案 2: 只修复关键包

只修复影响队列阻塞的关键包：
- PyTorch: 2.1.2+cu118
- ONNX Runtime: 1.18.0 (或 1.16.0)
- NumPy: 1.22.4
- OpenCV: 4.7.0.72
- Librosa: 0.8.1

### 方案 3: 保持当前版本

如果当前版本可以正常工作，可以保持当前版本，但需要测试功能是否正常。

## 更新日期

2025-11-09

