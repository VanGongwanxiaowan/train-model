# Gradio 服务恢复报告

## ✅ 服务状态

### 当前状态

- **Gradio 服务**: ✅ 运行中
- **进程**: `python app.py` (PID: 1767)
- **监听地址**: 0.0.0.0:7860
- **容器内访问**: ✅ 正常 (HTTP 200)
- **外部访问**: ✅ 正常 (HTTP 200)
- **服务URL**: http://192.168.191.56:7860/

### 服务信息

- **容器名称**: starpainting-digital-human-service-1
- **端口映射**: 7860/tcp -> 0.0.0.0:7860 ✅
- **服务状态**: 运行中
- **启动时间**: 2025-11-09 14:51:01

## 恢复步骤

### 1. 检查服务状态 ✅

```bash
docker exec starpainting-digital-human-service-1 bash -c "ps aux | grep 'python app.py' | grep -v grep"
```

### 2. 重启 Gradio 服务 ✅

```bash
docker exec starpainting-digital-human-service-1 bash -c "source /opt/conda/etc/profile.d/conda.sh && conda activate human && cd /app/HeyGem-Linux-Python-Hack && nohup python app.py > /tmp/gradio_new.log 2>&1 &"
```

### 3. 验证服务 ✅

```bash
# 容器内访问
docker exec starpainting-digital-human-service-1 bash -c "curl -s http://localhost:7860/ | head -5"

# 外部访问
curl -s http://192.168.191.56:7860/ | head -5
```

## 服务日志

### 启动日志

```
[2025-11-09 14:51:01] [app.py[line:214]] [INFO] [trans_dh_service 初始化完成。]
VideoProcessor init done
Running on local URL:  http://0.0.0.0:7860
[2025-11-09 14:51:01] [_client.py[line:1025]] [INFO] [HTTP Request: GET http://localhost:7860/startup-events "HTTP/1.1 200 OK"]
[2025-11-09 14:51:01] [_client.py[line:1025]] [INFO] [HTTP Request: HEAD http://localhost:7860/ "HTTP/1.1 200 OK"]
```

### 注意事项

1. **模型加载错误**: 有一个模型加载错误（`RuntimeError: PytorchStreamReader failed reading zip archive`），但这不影响 Gradio 服务的启动和运行。

2. **服务正常运行**: 尽管有模型加载错误，Gradio 服务仍然正常启动并可以访问。

## 访问地址

- **Gradio 服务**: http://192.168.191.56:7860/
- **FastAPI 服务**: http://192.168.191.56:8308/
- **FastAPI 健康检查**: http://192.168.191.56:8308/health

## 验证方法

### 1. 检查进程

```bash
docker exec starpainting-digital-human-service-1 bash -c "ps aux | grep 'python app.py' | grep -v grep"
```

### 2. 检查服务

```bash
# 容器内
docker exec starpainting-digital-human-service-1 bash -c "curl -s http://localhost:7860/ | head -5"

# 外部
curl -s http://192.168.191.56:7860/ | head -5
```

### 3. 检查日志

```bash
docker exec starpainting-digital-human-service-1 bash -c "tail -f /tmp/gradio_new.log"
```

## 相关文件

- `app.py` - Gradio 应用主文件
- `/tmp/gradio_new.log` - Gradio 服务日志
- `start_gradio.sh` - Gradio 服务启动脚本

## 更新日期

2025-11-09 14:51

